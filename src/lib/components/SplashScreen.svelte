<script>
  import { getEastCoastDate } from "$lib/utils/storage";
  import crosswords from "$lib/data/crosswords.json";

  let { onPlay } = $props();
  let isMobileDevice = $state(false);

  // Get today's puzzle or fall back to the first available puzzle
  function getTodaysPuzzle() {
    const todayDate = getEastCoastDate();
    const puzzleDates = Object.keys(crosswords);

    // Try to get today's puzzle
    if (crosswords[todayDate]) {
      return crosswords[todayDate];
    }

    // Fall back to first available puzzle
    const firstAvailableDate = puzzleDates.sort()[0];
    return crosswords[firstAvailableDate];
  }

  const puzzle = getTodaysPuzzle();
  const todayDate = getEastCoastDate();

  $effect(() => {
    isMobileDevice = window.matchMedia("(max-width: 768px)").matches;
  });

  // Format the date
  function formatDate(dateString) {
    const date = new Date(dateString);
    return date.toLocaleDateString("en-US", {
      weekday: "long",
      month: "long",
      day: "numeric",
      year: "numeric",
    });
  }
</script>

<div
  class="fixed inset-0 bg-gray-200 dark:bg-[#222] flex flex-col items-center px-4"
>
  <div class="pt-22 mt-7.5 md:mt-20 flex flex-col items-center gap-4">
    <!-- Placeholder logo -->
    <svg
      width="334"
      height="141"
      viewBox="0 0 334 141"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <rect width="334" height="141" rx="10" fill="black" />
      <rect x="6" y="6" width="65" height="65" fill="black" />
      <path d="M6 70H71V135H14C9.58172 135 6 131.418 6 127V70Z" fill="white" />
      <path d="M71 6H135V71H71V6Z" fill="white" />
      <rect x="71" y="70" width="64" height="65" fill="black" />
      <path
        d="M39.7301 21.8C38.0634 21.8 36.4967 22.1667 35.0301 22.9C33.5967 23.6333 32.3467 24.6833 31.2801 26.05C30.2134 27.3833 29.3801 29 28.7801 30.9C28.1801 32.8 27.8801 34.9167 27.8801 37.25C27.8801 39.5833 28.1634 41.7 28.7301 43.6C29.3301 45.5 30.1634 47.1333 31.2301 48.5C32.2967 49.8333 33.5967 50.8667 35.1301 51.6C36.6634 52.3333 38.3801 52.7 40.2801 52.7C42.3134 52.7 44.0967 52.25 45.6301 51.35C47.1967 50.45 48.4967 49.2333 49.5301 47.7C50.5967 46.1333 51.3801 44.3667 51.8801 42.4L54.5801 43.4C54.0134 45.7667 53.0634 47.8667 51.7301 49.7C50.3967 51.5 48.7301 52.9167 46.7301 53.95C44.7634 54.9833 42.5301 55.5 40.0301 55.5C37.5301 55.5 35.2301 55.0667 33.1301 54.2C31.0634 53.3 29.2467 52.05 27.6801 50.45C26.1467 48.8167 24.9634 46.8833 24.1301 44.65C23.2967 42.4167 22.8801 39.95 22.8801 37.25C22.8801 34.5833 23.3134 32.1333 24.1801 29.9C25.0467 27.6667 26.2467 25.7333 27.7801 24.1C29.3467 22.4667 31.1301 21.2167 33.1301 20.35C35.1634 19.45 37.3467 19 39.6801 19C41.9134 19 43.8467 19.35 45.4801 20.05C47.1467 20.7167 48.5134 21.6833 49.5801 22.95C50.6801 24.1833 51.4967 25.65 52.0301 27.35L50.3301 27.15L51.1301 19.5H53.8801V30.2H50.8801C50.3134 28.5 49.5301 27.0333 48.5301 25.8C47.5634 24.5333 46.3467 23.55 44.8801 22.85C43.4467 22.15 41.7301 21.8 39.7301 21.8Z"
        fill="white"
      />
      <path
        d="M94.5014 106.8C94.5014 108.767 94.7347 110.417 95.2014 111.75C95.668 113.083 96.318 114.167 97.1514 115C97.9847 115.8 98.968 116.383 100.101 116.75C101.268 117.117 102.551 117.3 103.951 117.3C105.318 117.3 106.568 117.117 107.701 116.75C108.835 116.35 109.818 115.75 110.651 114.95C111.485 114.117 112.118 113.033 112.551 111.7C112.985 110.333 113.201 108.683 113.201 106.75V87.8C113.201 87.6 113.085 87.4333 112.851 87.3C112.618 87.1667 112.285 87.05 111.851 86.95C111.451 86.85 111.001 86.7833 110.501 86.75C110.001 86.6833 109.485 86.65 108.951 86.65H108.351V84.5H120.851V86.65H120.301C119.535 86.65 118.835 86.7333 118.201 86.9C117.601 87.0667 117.118 87.3333 116.751 87.7C116.385 88.0333 116.201 88.5167 116.201 89.15V106.75C116.201 109.183 115.868 111.267 115.201 113C114.535 114.733 113.601 116.167 112.401 117.3C111.235 118.4 109.868 119.217 108.301 119.75C106.768 120.25 105.101 120.5 103.301 120.5C101.335 120.5 99.5347 120.233 97.9014 119.7C96.268 119.167 94.8347 118.35 93.6014 117.25C92.4014 116.15 91.468 114.75 90.8014 113.05C90.168 111.317 89.8514 109.233 89.8514 106.8V88.45C89.8514 87.7167 89.4514 87.2333 88.6514 87C87.8514 86.7667 86.8514 86.65 85.6514 86.65H85.1514V84.5H99.2014V86.65H98.7514C98.2847 86.65 97.8014 86.6667 97.3014 86.7C96.8014 86.7 96.3347 86.7333 95.9014 86.8C95.468 86.8333 95.118 86.8833 94.8514 86.95C94.618 86.9833 94.5014 87.05 94.5014 87.15V106.8Z"
        fill="white"
      />
      <rect x="263" y="6" width="64" height="65" fill="black" />
      <path
        d="M263 70H327V127C327 131.418 323.418 135 319 135H263V70Z"
        fill="white"
      />
      <path
        d="M296.22 52.8C297.72 52.8 299.037 52.5833 300.17 52.15C301.304 51.6833 302.17 50.9833 302.77 50.05C303.404 49.0833 303.72 47.85 303.72 46.35C303.72 45.05 303.454 43.9833 302.92 43.15C302.387 42.2833 301.654 41.5833 300.72 41.05C299.82 40.4833 298.787 40 297.62 39.6C296.454 39.2 295.254 38.8333 294.02 38.5C292.687 38.1333 291.37 37.7167 290.07 37.25C288.77 36.75 287.587 36.1167 286.52 35.35C285.487 34.5833 284.654 33.6167 284.02 32.45C283.42 31.2833 283.12 29.8333 283.12 28.1C283.12 26.2333 283.587 24.6333 284.52 23.3C285.454 21.9333 286.704 20.8833 288.27 20.15C289.87 19.3833 291.637 19 293.57 19C295.17 19 296.637 19.2333 297.97 19.7C299.304 20.1667 300.504 20.9333 301.57 22C302.67 23.0667 303.57 24.5333 304.27 26.4L302.52 26.2L303.22 19.5H305.82V28.75H302.97C302.47 27.2833 301.787 26.0333 300.92 25C300.054 23.9333 299.02 23.1167 297.82 22.55C296.654 21.95 295.37 21.65 293.97 21.65C292.537 21.65 291.304 21.9 290.27 22.4C289.27 22.8667 288.504 23.5333 287.97 24.4C287.437 25.2667 287.17 26.3167 287.17 27.55C287.17 28.6833 287.42 29.65 287.92 30.45C288.454 31.2167 289.17 31.85 290.07 32.35C290.97 32.85 292.004 33.2833 293.17 33.65C294.337 34.0167 295.537 34.3667 296.77 34.7C298.17 35.0667 299.537 35.5 300.87 36C302.204 36.4667 303.404 37.0833 304.47 37.85C305.57 38.6167 306.437 39.6 307.07 40.8C307.704 42 308.02 43.5 308.02 45.3C308.02 47.4667 307.487 49.3167 306.42 50.85C305.354 52.3833 303.937 53.55 302.17 54.35C300.437 55.1167 298.52 55.5 296.42 55.5C294.487 55.5 292.654 55.2 290.92 54.6C289.187 53.9667 287.654 53 286.32 51.7C285.02 50.3667 284.02 48.6333 283.32 46.5L285.42 47.1L284.72 55H281.92V44H284.77C285.337 45.8 286.154 47.3667 287.22 48.7C288.32 50 289.62 51.0167 291.12 51.75C292.654 52.45 294.354 52.8 296.22 52.8Z"
        fill="white"
      />
      <rect x="135" y="6" width="64" height="65" fill="black" />
      <path d="M135 70H199V135H135V70Z" fill="white" />
      <path d="M199 6H263V71H199V6Z" fill="white" />
      <rect x="199" y="70" width="64" height="65" fill="black" />
      <path
        d="M167.025 55.5C164.558 55.5 162.258 55.0667 160.125 54.2C158.025 53.3 156.175 52.05 154.575 50.45C152.975 48.8167 151.725 46.8833 150.825 44.65C149.958 42.4167 149.525 39.95 149.525 37.25C149.525 34.55 149.958 32.0833 150.825 29.85C151.725 27.6167 152.975 25.7 154.575 24.1C156.175 22.4667 158.025 21.2167 160.125 20.35C162.258 19.45 164.558 19 167.025 19C169.458 19 171.725 19.45 173.825 20.35C175.958 21.2167 177.825 22.4667 179.425 24.1C181.025 25.7 182.275 27.6167 183.175 29.85C184.075 32.0833 184.525 34.55 184.525 37.25C184.525 39.95 184.075 42.4167 183.175 44.65C182.275 46.8833 181.025 48.8167 179.425 50.45C177.825 52.05 175.958 53.3 173.825 54.2C171.725 55.0667 169.458 55.5 167.025 55.5ZM167.025 52.8C168.825 52.8 170.491 52.45 172.025 51.75C173.558 51.0167 174.875 49.9667 175.975 48.6C177.108 47.2333 177.975 45.6 178.575 43.7C179.208 41.7667 179.525 39.6167 179.525 37.25C179.525 34.8833 179.208 32.75 178.575 30.85C177.975 28.9167 177.108 27.2667 175.975 25.9C174.875 24.5333 173.558 23.5 172.025 22.8C170.491 22.0667 168.825 21.7 167.025 21.7C165.225 21.7 163.558 22.0667 162.025 22.8C160.491 23.5 159.158 24.5333 158.025 25.9C156.925 27.2667 156.058 28.9167 155.425 30.85C154.825 32.75 154.525 34.8833 154.525 37.25C154.525 39.6167 154.825 41.7667 155.425 43.7C156.058 45.6 156.925 47.2333 158.025 48.6C159.158 49.9667 160.491 51.0167 162.025 51.75C163.558 52.45 165.225 52.8 167.025 52.8Z"
        fill="white"
      />
      <path
        d="M103.438 38.85L107.888 38.1L115.288 51.4C115.521 51.8333 115.788 52.15 116.088 52.35C116.421 52.55 116.805 52.6833 117.238 52.75C117.705 52.8167 118.221 52.85 118.788 52.85H119.188V55H111.788L103.438 38.85ZM97.2381 52.35C97.2381 52.45 97.3548 52.5333 97.5881 52.6C97.8214 52.6333 98.1214 52.6833 98.4881 52.75C98.8881 52.7833 99.3214 52.8167 99.7881 52.85C100.255 52.85 100.705 52.85 101.138 52.85H101.738V55H87.9381V52.85H88.4381C89.6048 52.85 90.5881 52.7333 91.3881 52.5C92.1881 52.2667 92.5881 51.7833 92.5881 51.05V23.45C92.5881 22.7167 92.1881 22.2333 91.3881 22C90.5881 21.7667 89.6048 21.65 88.4381 21.65H87.9381V19.5H102.288C104.988 19.5 107.288 19.9333 109.188 20.8C111.121 21.6333 112.605 22.8167 113.638 24.35C114.671 25.85 115.188 27.6 115.188 29.6C115.188 31.2667 114.821 32.7667 114.088 34.1C113.355 35.4 112.305 36.5 110.938 37.4C109.571 38.3 107.938 38.9333 106.038 39.3C105.638 39.4 105.205 39.4833 104.738 39.55C104.305 39.5833 103.855 39.6167 103.388 39.65C102.921 39.6833 102.438 39.7 101.938 39.7H96.2381V37.2H101.988C103.888 37.2 105.438 36.9 106.638 36.3C107.871 35.6667 108.771 34.7833 109.338 33.65C109.905 32.5167 110.188 31.1667 110.188 29.6C110.188 28.0667 109.888 26.75 109.288 25.65C108.688 24.5167 107.788 23.65 106.588 23.05C105.421 22.45 103.955 22.15 102.188 22.15H97.2381V52.35Z"
        fill="black"
      />
      <path
        d="M149.472 120V117.85H150.022C150.789 117.85 151.472 117.783 152.072 117.65C152.706 117.483 153.206 117.233 153.572 116.9C153.939 116.533 154.122 116.083 154.122 115.55V88.45C154.122 87.95 153.939 87.5833 153.572 87.35C153.206 87.0833 152.706 86.9 152.072 86.8C151.472 86.7 150.789 86.65 150.022 86.65H149.472V84.5H160.372L177.922 115.4L177.272 115.55V87.6C177.272 87.4 177.056 87.2333 176.622 87.1C176.222 86.9667 175.689 86.8667 175.022 86.8C174.356 86.7 173.656 86.65 172.922 86.65H172.072V84.5H184.922V86.65H184.372C183.606 86.65 182.906 86.7333 182.272 86.9C181.639 87.0333 181.139 87.2833 180.772 87.65C180.406 87.9833 180.222 88.4167 180.222 88.95V120H175.672L156.472 86.25L157.122 86.05V116.9C157.122 117.067 157.339 117.233 157.772 117.4C158.206 117.533 158.756 117.65 159.422 117.75C160.089 117.817 160.772 117.85 161.472 117.85H162.322V120H149.472Z"
        fill="black"
      />
      <path
        d="M36.1705 116.05V87.05H33.2205C31.7872 87.05 30.6205 87.1167 29.7205 87.25C28.8205 87.35 28.1538 87.5667 27.7205 87.9C27.2872 88.2333 27.0205 88.7167 26.9205 89.35L26.3705 94.15H23.9205V84.5H53.0705V94.15H50.6205L50.0205 89.35C49.9872 88.7167 49.7372 88.2333 49.2705 87.9C48.8372 87.5667 48.1705 87.35 47.2705 87.25C46.3705 87.1167 45.2038 87.05 43.7705 87.05H40.8205V116.05C40.8205 116.783 41.2205 117.267 42.0205 117.5C42.8205 117.733 43.8205 117.85 45.0205 117.85H45.8205V120H31.1705V117.85H31.9705C33.1705 117.85 34.1705 117.733 34.9705 117.5C35.7705 117.267 36.1705 116.783 36.1705 116.05Z"
        fill="black"
      />
      <path
        d="M232.22 52.8C233.72 52.8 235.037 52.5833 236.17 52.15C237.304 51.6833 238.17 50.9833 238.77 50.05C239.404 49.0833 239.72 47.85 239.72 46.35C239.72 45.05 239.454 43.9833 238.92 43.15C238.387 42.2833 237.654 41.5833 236.72 41.05C235.82 40.4833 234.787 40 233.62 39.6C232.454 39.2 231.254 38.8333 230.02 38.5C228.687 38.1333 227.37 37.7167 226.07 37.25C224.77 36.75 223.587 36.1167 222.52 35.35C221.487 34.5833 220.654 33.6167 220.02 32.45C219.42 31.2833 219.12 29.8333 219.12 28.1C219.12 26.2333 219.587 24.6333 220.52 23.3C221.454 21.9333 222.704 20.8833 224.27 20.15C225.87 19.3833 227.637 19 229.57 19C231.17 19 232.637 19.2333 233.97 19.7C235.304 20.1667 236.504 20.9333 237.57 22C238.67 23.0667 239.57 24.5333 240.27 26.4L238.52 26.2L239.22 19.5H241.82V28.75H238.97C238.47 27.2833 237.787 26.0333 236.92 25C236.054 23.9333 235.02 23.1167 233.82 22.55C232.654 21.95 231.37 21.65 229.97 21.65C228.537 21.65 227.304 21.9 226.27 22.4C225.27 22.8667 224.504 23.5333 223.97 24.4C223.437 25.2667 223.17 26.3167 223.17 27.55C223.17 28.6833 223.42 29.65 223.92 30.45C224.454 31.2167 225.17 31.85 226.07 32.35C226.97 32.85 228.004 33.2833 229.17 33.65C230.337 34.0167 231.537 34.3667 232.77 34.7C234.17 35.0667 235.537 35.5 236.87 36C238.204 36.4667 239.404 37.0833 240.47 37.85C241.57 38.6167 242.437 39.6 243.07 40.8C243.704 42 244.02 43.5 244.02 45.3C244.02 47.4667 243.487 49.3167 242.42 50.85C241.354 52.3833 239.937 53.55 238.17 54.35C236.437 55.1167 234.52 55.5 232.42 55.5C230.487 55.5 228.654 55.2 226.92 54.6C225.187 53.9667 223.654 53 222.32 51.7C221.02 50.3667 220.02 48.6333 219.32 46.5L221.42 47.1L220.72 55H217.92V44H220.77C221.337 45.8 222.154 47.3667 223.22 48.7C224.32 50 225.62 51.0167 227.12 51.75C228.654 52.45 230.354 52.8 232.22 52.8Z"
        fill="black"
      />
      <path
        d="M244.004 109.25V120H217.354V117.85H217.854C219.021 117.85 220.004 117.733 220.804 117.5C221.604 117.267 222.004 116.783 222.004 116.05V88.45C222.004 87.7167 221.604 87.2333 220.804 87C220.004 86.7667 219.021 86.65 217.854 86.65H217.354V84.5H242.654V94H240.104L239.554 89.45C239.454 88.85 239.187 88.3833 238.754 88.05C238.321 87.6833 237.654 87.45 236.754 87.35C235.854 87.2167 234.687 87.15 233.254 87.15H226.654V117.35H234.604C235.671 117.35 236.587 117.317 237.354 117.25C238.154 117.183 238.804 117.067 239.304 116.9C239.804 116.7 240.171 116.45 240.404 116.15C240.671 115.85 240.837 115.467 240.904 115L241.454 109.25H244.004ZM225.404 100.65C226.904 100.583 228.354 100.533 229.754 100.5C231.154 100.467 232.521 100.417 233.854 100.35C235.187 100.283 236.521 100.2 237.854 100.1V103.65C236.521 103.517 235.187 103.417 233.854 103.35C232.521 103.25 231.154 103.183 229.754 103.15C228.354 103.083 226.904 103.033 225.404 103V100.65Z"
        fill="white"
      />
      <mask
        id="mask0_132_1083"
        style="mask-type:luminance"
        maskUnits="userSpaceOnUse"
        x="274"
        y="82"
        width="42"
        height="41"
      >
        <path
          d="M295.196 121.929C305.829 121.929 314.448 113.31 314.448 102.677C314.448 92.0441 305.829 83.425 295.196 83.425C284.563 83.425 275.944 92.0441 275.944 102.677C275.944 113.31 284.563 121.929 295.196 121.929Z"
          fill="white"
          stroke="white"
          stroke-width="2"
          stroke-linejoin="round"
        />
        <path
          d="M291.346 102.677V96.0079L297.121 99.3424L302.897 102.677L297.121 106.011L291.346 109.346V102.677Z"
          fill="black"
          stroke="black"
          stroke-width="2"
          stroke-linejoin="round"
        />
      </mask>
      <g mask="url(#mask0_132_1083)">
        <path
          d="M272.094 79.5747H318.299V125.779H272.094V79.5747Z"
          fill="black"
        />
      </g>
    </svg>

    <!-- Tagline -->
    <h2 class="text-black dark:text-white text-xl text-center font-light">
      a music crossword!
    </h2>

    <!-- Date and Title -->
    <div class="mt-4 text-center">
      <div class="text-black dark:text-white text-lg font-medium">
        {formatDate(todayDate)}
      </div>
      {#if puzzle.title}
        <div class="text-black dark:text-white text-base mt-0.5 font-light">
          {puzzle.title}
        </div>
      {/if}
    </div>

    <!-- Play Button -->
    <button
      onclick={onPlay}
      class="rounded-xs mt-12 px-12 py-3 bg-black dark:bg-white text-white dark:text-black text-xl font-bold hover:bg-gray-900 dark:hover:bg-gray-300 transition-colors"
    >
      Start
    </button>
  </div>

  <!-- Spacer for mobile -->
  <div class="flex-1 md:hidden"></div>
</div>

<style>
  :global(body) {
    @media (max-width: 768px) {
      overflow: hidden;
    }
  }
</style>
